<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <meta name="theme-color" content="#060608">
    <title>offchat</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üîí</text></svg>">
</head>

<body data-page="chat">

    <!-- Ambient background -->
    <div class="ambient-grid" aria-hidden="true"></div>

    <!-- Password Modal -->
    <div id="password-modal" class="password-modal" hidden>
        <div class="password-modal__backdrop"></div>
        <div class="password-modal__card">
            <div class="password-modal__icon">
                <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
                    <rect x="6" y="14" width="20" height="14" rx="3" stroke="var(--accent)" stroke-width="1.5" />
                    <path d="M10 14V11a6 6 0 0112 0v3" stroke="var(--accent)" stroke-width="1.5"
                        stroke-linecap="round" />
                    <circle cx="16" cy="21" r="2" fill="var(--accent)" opacity="0.7" />
                    <path d="M16 23v2" stroke="var(--accent)" stroke-width="1.5" stroke-linecap="round" />
                </svg>
            </div>
            <h2 class="password-modal__title">this room is protected</h2>
            <p class="password-modal__desc">enter the password to join this encrypted room</p>
            <div class="password-modal__input-wrap">
                <input type="password" id="modal-password-input" class="password-modal__input"
                    placeholder="room password" autocomplete="off" autocorrect="off" autocapitalize="off"
                    spellcheck="false" maxlength="128" autofocus>
                <button id="modal-password-visibility" class="btn-eye" type="button"
                    aria-label="Toggle password visibility">
                    <svg id="modal-eye-open" width="16" height="16" viewBox="0 0 16 16" fill="none">
                        <path d="M1 8s2.5-5 7-5 7 5 7 5-2.5 5-7 5-7-5-7-5z" stroke="currentColor" stroke-width="1.2"
                            stroke-linecap="round" stroke-linejoin="round" />
                        <circle cx="8" cy="8" r="2" stroke="currentColor" stroke-width="1.2" />
                    </svg>
                    <svg id="modal-eye-closed" width="16" height="16" viewBox="0 0 16 16" fill="none" hidden>
                        <path d="M1 8s2.5-5 7-5 7 5 7 5-2.5 5-7 5-7-5-7-5z" stroke="currentColor" stroke-width="1.2"
                            stroke-linecap="round" stroke-linejoin="round" />
                        <circle cx="8" cy="8" r="2" stroke="currentColor" stroke-width="1.2" />
                        <path d="M2 2l12 12" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" />
                    </svg>
                </button>
            </div>
            <div id="modal-error" class="password-modal__error" hidden>wrong password</div>
            <button id="modal-submit" class="password-modal__btn">
                <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
                    <path d="M2.5 7h9M8 3.5L11.5 7 8 10.5" stroke="currentColor" stroke-width="1.3"
                        stroke-linecap="round" stroke-linejoin="round" />
                </svg>
                <span>enter room</span>
            </button>
            <a href="/" class="password-modal__back">‚Üê back to home</a>
        </div>
    </div>

    <!-- QR Code Modal -->
    <div id="qr-modal" class="qr-modal" hidden>
        <div class="qr-modal__backdrop" id="qr-backdrop"></div>
        <div class="qr-modal__card">
            <h2 class="qr-modal__title">share this room</h2>
            <p class="qr-modal__desc">scan to join the encrypted chat</p>
            <div id="qr-container" class="qr-container"></div>
            <p class="qr-url" id="qr-url"></p>
            <button id="qr-close" class="qr-modal__btn">close</button>
        </div>
    </div>

    <!-- Drag & Drop Overlay -->
    <div id="drag-overlay" class="drag-overlay" hidden>
        <div class="drag-overlay__content">
            <svg width="48" height="48" viewBox="0 0 48 48" fill="none">
                <rect x="4" y="4" width="40" height="40" rx="8" stroke="var(--accent)" stroke-width="2"
                    stroke-dasharray="6 4" opacity="0.6" />
                <path d="M24 14v14M18 22l6 6 6-6" stroke="var(--accent)" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round" />
                <path d="M14 34h20" stroke="var(--accent)" stroke-width="2" stroke-linecap="round" />
            </svg>
            <p>drop to encrypt & send</p>
        </div>
    </div>

    <div class="chat-container" id="chat-container">

        <!-- Header -->
        <header class="chat-header">
            <div class="header-left">
                <a href="/" class="logo-sm">off<span class="accent">chat</span></a>
                <span class="header-sep">/</span>
                <span id="room-name" class="room-id"></span>
                <span id="connection-status" class="connection-status" title="connected"></span>
                <span id="lock-indicator" class="lock-indicator" hidden title="Password protected">
                    <svg width="12" height="12" viewBox="0 0 12 12" fill="none">
                        <rect x="2.5" y="5.5" width="7" height="5" rx="1" stroke="currentColor" stroke-width="1" />
                        <path d="M4 5.5V4a2 2 0 014 0v1.5" stroke="currentColor" stroke-width="1"
                            stroke-linecap="round" />
                    </svg>
                </span>
            </div>
            <div class="header-right">
                <!-- QR Code button -->
                <button id="qr-btn" class="btn-icon" title="Show QR code">
                    <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
                        <rect x="1" y="1" width="5" height="5" rx="1" stroke="currentColor" stroke-width="1.2" />
                        <rect x="8" y="1" width="5" height="5" rx="1" stroke="currentColor" stroke-width="1.2" />
                        <rect x="1" y="8" width="5" height="5" rx="1" stroke="currentColor" stroke-width="1.2" />
                        <rect x="9.5" y="9.5" width="2" height="2" rx="0.5" fill="currentColor" />
                        <rect x="3" y="3" width="1.5" height="1.5" rx="0.3" fill="currentColor" />
                        <rect x="10" y="3" width="1.5" height="1.5" rx="0.3" fill="currentColor" />
                        <rect x="3" y="10" width="1.5" height="1.5" rx="0.3" fill="currentColor" />
                    </svg>
                </button>

                <!-- Copy link button -->
                <button id="copy-link" class="btn-icon" title="Copy room link">
                    <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
                        <rect x="4.5" y="4.5" width="7" height="7" rx="1.5" stroke="currentColor" stroke-width="1.2" />
                        <path d="M9.5 4.5V3a1.5 1.5 0 00-1.5-1.5H3A1.5 1.5 0 001.5 3v5A1.5 1.5 0 003 9.5h1.5"
                            stroke="currentColor" stroke-width="1.2" />
                    </svg>
                </button>

                <!-- Destroy room button -->
                <button id="destroy-btn" class="btn-icon btn-destroy" title="Destroy room">
                    <svg class="destroy-icon-default" width="14" height="14" viewBox="0 0 14 14" fill="none">
                        <path d="M7 1v5" stroke="currentColor" stroke-width="1.3" stroke-linecap="round" />
                        <path d="M3.5 3.5a5 5 0 107 0" stroke="currentColor" stroke-width="1.3"
                            stroke-linecap="round" />
                    </svg>
                    <span class="destroy-confirm-text">?</span>
                </button>

                <div class="header-meta">
                    <span class="presence">
                        <span class="presence-dot"></span>
                        <span id="participants">0</span>
                    </span>
                    <span class="header-sep">¬∑</span>
                    <span id="timer" class="timer">10:00</span>
                </div>
                <div class="encryption-badge" title="End-to-end encrypted">
                    <svg width="12" height="12" viewBox="0 0 12 12" fill="none">
                        <rect x="2" y="5.5" width="8" height="5" rx="1" stroke="currentColor" stroke-width="1.2" />
                        <path d="M4 5.5V4a2 2 0 114 0v1.5" stroke="currentColor" stroke-width="1.2"
                            stroke-linecap="round" />
                    </svg>
                    <span>E2E</span>
                </div>
            </div>
        </header>

        <!-- Messages -->
        <div id="messages" class="messages">
            <div class="messages__empty">
                <p>waiting for messages...</p>
                <p class="dim">everything here is end-to-end encrypted</p>
            </div>
        </div>

        <!-- Typing Indicator -->
        <div id="typing-indicator" class="typing-indicator" hidden>
            <span class="typing-dots">
                <span></span><span></span><span></span>
            </span>
            <span id="typing-text"></span>
        </div>

        <!-- Input -->
        <footer class="chat-footer">
            <span id="codename" class="my-codename"></span>
            <span class="prompt-arrow">‚Ä∫</span>
            <input type="text" id="msg-input" class="msg-input" placeholder="type message..." autocomplete="off"
                autocorrect="off" autocapitalize="off" spellcheck="false" autofocus>
            <input type="file" id="file-input" hidden>
            <button id="file-btn" class="btn-icon btn-file" title="Send encrypted file (max 25MB)">
                <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
                    <path
                        d="M15.5 9.5l-6.4 6.4a4 4 0 01-5.6-5.7l6.3-6.3a2.7 2.7 0 013.8 3.8l-6.3 6.3a1.3 1.3 0 01-1.9-1.9l5.7-5.7"
                        stroke="currentColor" stroke-width="1.3" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
            </button>
        </footer>
    </div>

    <script type="module" src="/js/chat.js"></script>
</body>

</html>